function SendNewsletterSubscription(e){$.validator.unobtrusive.parse(".formToValidate");var t=$(e).parents("form");return $(t).unbind("submit").bind("submit",(function(){return $(t).valid()?SendNewsletterRegistration(t):$("#errorNewsletter").css("visibility","visible"),!1})),$(t).submit(),!1}function SendNewsletterRegistration(e){e.find("input[type=button]").attr("disabled","disabled"),$(".spinner-wrap").css({display:"block",visibility:"visible",opacity:"1"}),$.ajax({type:"POST",dataType:"json",url:e.attr("action"),data:e.serialize(),success:function(e){},complete:function(t){var i=t.responseJSON.Status,r=t.responseJSON.Message;if(0!=e.find(".g-recaptcha").length&&grecaptcha.reset(e.find(".g-recaptcha").attr("data-widget-id")),e.find("input[type=button]").removeAttr("disabled"),$(".spinner-wrap").css({display:"none",visibility:"hidden",opacity:"0"}),0==i)$("#errorNewsletter").html(r),$("#errorNewsletter").css("visibility","visible");else{try{gtag("event","generate_lead",{event_category:"engagement",event_label:"newsletter"})}catch{}$("#errorNewsletter").html(r),$("#errorNewsletter").css("visibility","visible");var s=t.responseJSON.Url;window.location.href=s}}})}function SendPopupNewsletter(e){$.validator.unobtrusive.parse(".formToValidate");var t=$(e).parents("form");return $(t).unbind("submit").bind("submit",(function(){return $(t).valid()?SendPopupNewsletterForm(t):$("#errorNewsletter").css("visibility","visible"),!1})),$(t).submit(),!1}function SendPopupNewsletterForm(e){e.find("input[type=button]").attr("disabled","disabled"),$(".spinner-wrap").css({display:"block",visibility:"visible",opacity:"1"}),$.ajax({type:"POST",dataType:"json",url:e.attr("action"),data:e.serialize(),success:function(e){},complete:function(t){var i=t.responseJSON.Status,r=t.responseJSON.Message;if(0!=e.find(".g-recaptcha").length&&grecaptcha.reset(e.find(".g-recaptcha").attr("data-widget-id")),e.find("input[type=button]").removeAttr("disabled"),$(".spinner-wrap").css({display:"none",visibility:"hidden",opacity:"0"}),0==i)$("#errorNewsletter").html(r),$("#errorNewsletter").css("visibility","visible");else{try{gtag("event","generate_lead",{event_category:"engagement",event_label:"newsletter"})}catch{}$("#newsletter-popup .newsletter-formContent").hide(),$("#newsletter-popup .newsletter-msg").show()}}})}